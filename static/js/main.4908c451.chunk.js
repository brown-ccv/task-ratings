(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{17:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return"<div class=".concat(n?"center_container":t?"main-prompt":"main",">").concat(e,"</div>")}},18:function(e,t,n){"use strict";n.d(t,"d",function(){return o}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"a",function(){return c});var r=n(15),o=function(e){return new Promise(function(t){return setTimeout(t,e)})},a=function(){var e=r.jsPsych.turk.turkInfo();return"".concat(e.workerId,":").concat(e.assignmentId)},i=function(){return function(e){for(var t=window.location.search.substring(1).split("&"),n=0;n<t.length;n++){var r=t[n].split("=");if(decodeURIComponent(r[0])===e)return decodeURIComponent(r[1])}}("PROLIFIC_PID")},c=function(e){var t=new AudioContext,n=t.createOscillator(),r=t.createGain();n.type=e.type,n.connect(r),n.frequency.setValueAtTime(e.frequency,0),console.log(t.currentTime),r.connect(t.destination),n.start(),n.stop(t.currentTime+.4)}},21:function(e,t,n){"use strict";n.d(t,"b",function(){return u}),n.d(t,"a",function(){return d});var r=n(4),o=n(27),a=n(28),i=n.n(a),c=!1;if(r.b.USE_ELECTRON){var s=window.require("electron");c=s.ipcRenderer}var u=function(){var e=r.b.USE_PHOTODIODE?"visible":"invisible";return'<div class="photodiode-box '.concat(e,'" id="photodiode-box">\n\t\t\t\t\t\t\t\t\t<span id="photodiode-spot" class="photodiode-spot"></span>\n  \t\t\t\t\t\t\t\t</div>')},d=function(e){if(r.b.USE_PHOTODIODE){var t=e;e<o.eventCodes.open_task&&(t=1),function e(t,n){n>0&&function(e,t){i()(".photodiode-spot").css({"background-color":"black"}),setTimeout(function(){i()(".photodiode-spot").css({"background-color":"white"}),t()},e)}(t,function(){setTimeout(function(){e(t,n-1)},t)})}(40,t),c&&c.send("trigger",e)}}},27:function(e,t){e.exports={eventCodes:{fixation:1,evidence:5,show_earnings:7,test_connect:32,open_task:18}}},36:function(e,t,n){"use strict";(function(e){n.d(t,"b",function(){return _}),n.d(t,"a",function(){return E});var r=n(14),o=n.n(r),a=n(42),i=n(20),c=n(4),s=n(21),u=n(17),d=n(15),l=!1;if(c.b.USE_ELECTRON){var p=window.require("electron");l=p.ipcRenderer}var _=function(){document.title=c.e;var t='\n  <div class="d-flex flex-column align-items-center">\n  <p>'.concat(c.d.instructions.camera,'</p>\n  <video id="camera" width="640" height="480" autoplay></video>\n  </div>\n  ');return{type:"html_button_response",stimulus:Object(u.a)(t,!0)+Object(s.b)(),choices:[c.d.prompt.continue.button],response_ends_trial:!0,on_load:function(){var t=d.jsPsych.data.get().values()[0].participant_id,n=document.getElementById("camera"),r=function(r,o){console.log(r),"cameraCapture"===o&&(n.srcObject=r);var a=[];window[o]=new MediaRecorder(r,{mimeType:"video/webm"}),window[o].addEventListener("dataavailable",function(e){e.data.size>0&&a.push(e.data)}),window[o].addEventListener("stop",function(){!function(t,n,r){var o=new FileReader,a="pid_".concat(r,"_").concat(n,"_").concat(Date.now(),".webm");o.onload=function(){if(2===o.readyState){var n=new e(o.result);l.send("save_video",a,n),console.log("Saving ".concat(JSON.stringify({fileName:a,size:t.size})))}},o.readAsArrayBuffer(t)}(new Blob(a),o,t)})};navigator.mediaDevices.getUserMedia({video:!0}).then(function(e){return r(e,"cameraCapture")}),window.require("electron").desktopCapturer.getSources({types:["window"]}).then(function(){var e=Object(i.a)(o.a.mark(function e(t){var n,i,s;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=Object(a.a)(t);try{for(n.s();!(i=n.n()).done;)(s=i.value).name===c.e&&navigator.mediaDevices.getUserMedia({video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:s.id}}}).then(function(e){r(e,"screenCapture")}).catch(function(e){return console.log(e)})}catch(o){n.e(o)}finally{n.f()}case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())},on_finish:function(){if(c.b.USE_CAMERA)try{window.cameraCapture.start(),window.screenCapture.start()}catch(e){window.alert("Camera permissions were not given, if you choose to proceed, your recording will not be saved. Please restart the experiment after you have given permission.")}}}},E=function(e){return{type:"html_keyboard_response",stimulus:Object(u.a)("<h1>".concat(c.d.task.recording_end,"</h1>"),!0)+Object(s.b)(),trial_duration:e,on_load:function(){if(c.b.USE_CAMERA){console.log("finished");try{window.cameraCapture.stop(),window.screenCapture.stop()}catch(e){window.alert("Your video recording was not saved")}}}}}}).call(this,n(72).Buffer)},4:function(e,t,n){"use strict";n.d(t,"e",function(){return d}),n.d(t,"d",function(){return h}),n.d(t,"b",function(){return O}),n.d(t,"a",function(){return u});var r=n(15),o=n(19),a=n.n(o),i=n(27);n.d(t,"c",function(){return i.eventCodes});var c=n(25),s=n(18),u={frequency:100*(i.eventCodes.open_task-9),type:"sine"},d="Ratings",l=!r.jsPsych.turk.turkInfo().outsideTurk,p=Object(s.b)()&&!l,_=!0,E="true"===Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_USE_PHOTODIODE:"true",REACT_APP_USE_EEG:"true",REACT_APP_VOLUME:"true"}).REACT_APP_FIREBASE;try{window.require("electron")}catch(P){_=!1}var f="true"===Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_USE_PHOTODIODE:"true",REACT_APP_USE_EEG:"true",REACT_APP_VOLUME:"true"}).REACT_APP_VIDEO&&_,m=_,b=_,h=n(70);if(!_){var v=n(71);a.a.merge(h,v)}var O=Object(c.init)({USE_PHOTODIODE:b,USE_EEG:m,USE_ELECTRON:_,USE_MTURK:l,USE_VOLUME:!0,USE_CAMERA:f,USE_PROLIFIC:p,USE_FIREBASE:E})},43:function(e){e.exports={a:"1.0.0"}},45:function(e,t,n){e.exports=n(85)},52:function(e,t,n){},54:function(e,t,n){},70:function(e){e.exports={task:{name:"Ratings Task",end:"The recording session has ended. Thank you for your time.",recording_end:"Your recording has ended."},prompt:{continue:{press:"Press any key to continue.",button:"Continue"},focus:"Make sure the photodiode is covering the spot and any external recordings have begun before continuing.",fullscreen:"Press 'cmd + ctrl + F' to toggle Fullscreen.",zoom:"Zoom in to enlarge the screen.",setting_up:"Setting up task..."},welcome:{large_window:"Please make this window as large as possible.",message:"Instructions"},userid:{set:"Please enter participant ID."},eventMarker:{found:"Note: event marker found.",not_found:"Note: no event marker found."},countdown:{message:"Timer",finish:"Current block has ended"},instructions:{adjust_volume:"Set tablet volume to 50/100.",camera:"Make sure the camera is pointing to you and your face is within the camera area.",check_event_marker:"Make sure the event marker is connected and then continue.",main_instructions:"For the next 30 min, we will record your brain activity while you are going about your daily activities. Please keep the tablet in the same room as you, and wear the CTM and the sling. Every 5 min, there will be a beep sound and you will be asked to submit your OCD symptom intensity using your keyboard. Please adjust the volume to 50/100. When you are ready, press the button to start.",enter_rating:"Please rate your OCD symptom intensity from 0-10. Press continue to submit your rating."}}},71:function(e){e.exports={welcome:{message:"Welcome to the NEURO experiment."},userid:{set:"Setting up user ID."}}},85:function(e,t,n){"use strict";n.r(t);var r=n(2),o=n.n(r),a=n(41),i=n.n(a),c=(n(52),n(14)),s=n.n(c),u=n(20),d=n(16),l=(n(54),n(55),n(56),n(23)),p=n(44);var E=function(e){var t=e.onLogin,n=e.envParticipantId,a=e.envStudyId,i=e.validationFunction,c=Object(r.useState)(""),s=Object(d.a)(c,2),u=s[0],_=s[1],E=Object(r.useState)(""),f=Object(d.a)(E,2),m=f[0],b=f[1],h=Object(r.useState)(!1),v=Object(d.a)(h,2),O=v[0],P=v[1];return Object(r.useEffect)(function(){_(n),b(a)},[n,a]),o.a.createElement("div",{className:"centered-h-v"},o.a.createElement("div",{className:"width-50"},O?o.a.createElement("div",{className:"alert alert-danger",role:"alert"},"The participant ID and study ID do not match"):null,o.a.createElement(l.a,{className:"centered-h-v",onSubmit:function(e){e.preventDefault(),i(u,m).then(function(e){e?t(e,m,u):P(!0)})}},o.a.createElement(l.a.Group,{className:"width-100",size:"lg",controlId:"participantId"},o.a.createElement(l.a.Label,null,"Participant ID"),o.a.createElement(l.a.Control,{autoFocus:!0,type:"participantId",value:u,onChange:function(e){return _(e.target.value)}})),o.a.createElement(l.a.Group,{className:"width-100",size:"lg",controlId:"studyId"},o.a.createElement(l.a.Label,null,"Study ID"),o.a.createElement(l.a.Control,{type:"studyId",value:m,onChange:function(e){return b(e.target.value)}})),o.a.createElement(p.a,{style:{width:"100%"},block:!0,size:"lg",type:"submit",disabled:!(u.length>0&&m.length>0)},"Log In"))))},f=n(15),m=n(4),b=n(21),h=n(17),v=function(){var e=Object(u.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",'<span style="color: green;">'.concat(m.d.eventMarker.found,"</span>"));case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),O=function(){return{type:"html_button_response",stimulus:Object(h.a)("<div><h2 id='usb-alert'></h2></div>",!0)+Object(b.b)(),prompt:["<br><h3>".concat(m.d.prompt.focus,"</h3>")],choices:[m.d.prompt.continue.button],on_load:function(){return v().then(function(e){return document.getElementById("usb-alert").innerHTML=e})}}},P=n(18),g=function(){return{type:"html_keyboard_response",stimulus:Object(h.a)("<h1>".concat(m.d.prompt.setting_up,"</h1>"),!0)+Object(b.b)(),trial_duration:2e3,on_load:function(){Object(b.a)(m.c.open_task),Object(P.a)(m.a)}}},w=n(25),y=[Object(w.showMessage)(m.b,{responseType:"html_button_response",message:m.d.task.name,responseEndsTrial:!0,buttons:[m.d.prompt.continue.button]})];m.b.USE_PHOTODIODE&&(y.push(O()),y.push(g()));for(var A={type:"html_keyboard_response",stimulus:"",timeline:y},U=n(19),C=function(e,t){var n=U.range(e,t,-1).map(function(e){var t=new Date(1e3*e).toISOString().substr(11,8);return{prompt:"<h1>".concat(t,"</h1>")}});return{type:"html_keyboard_response",stimulus:"<h1 class='countdown'>".concat(m.d.countdown.message,"</h1>"),response_ends_trial:!1,trial_duration:1e3,timeline:n,on_finish:function(e){e.countdown=!0}}},S=(n(19),function(){var e=new AudioContext,t=e.createOscillator(),n=e.createGain();t.type="sine",t.connect(n),n.connect(e.destination),t.start(),t.stop(e.currentTime+1)}),T=function(){return{type:"html_keyboard_response",stimulus:Object(h.a)("\n    <div class='instructions'>\n    <h1>".concat(m.d.countdown.finish,"</h1>\n    </div>\n    "),!0),response_ends_trial:!1,trial_duration:6e3,on_load:function(){var e=Object(u.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return S(),e.next=3,Object(P.d)(2500);case 3:S();case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()}},I=function(){return{type:"survey_multi_choice",preamble:Object(h.a)("<h1>".concat(m.d.instructions.enter_rating,"</h1>"),!0),questions:[{prompt:"Enter rating",name:"rating",options:[0,1,2,3,4,5,6,7,8,9,10],required:!0,horizontal:!0}],on_finish:function(e){e.submit_time=Date.now()}}},R=n(36),j=[A,Object(w.showMessage)(m.b,{responseType:"html_button_response",message:m.d.instructions.main_instructions,responseEndsTrial:!0,buttons:[m.d.prompt.continue.button]})],k=5;k>=0;k--)j.push(C(300*(k+1),300*k)),j.push(T()),j.push(I());m.b.USE_CAMERA&&(j.splice(1,0,Object(R.b)()),j.push(Object(R.a)(5e3))),j.push(Object(w.showMessage)(m.b,{duration:5e3,message:m.d.task.end}));var D=j;var L=function(e){var t=e.dataUpdateFunction,n=e.dataFinishFunction;return o.a.createElement("div",{className:"App"},o.a.createElement(f.Experiment,{settings:{timeline:D,on_data_update:function(e){return t(e)},on_finish:function(e){return n(e)}}}))},N=n(32);n(81);n(82).config();var M={apiKey:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_USE_PHOTODIODE:"true",REACT_APP_USE_EEG:"true",REACT_APP_VOLUME:"true"}).REACT_APP_apiKey,authDomain:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_USE_PHOTODIODE:"true",REACT_APP_USE_EEG:"true",REACT_APP_VOLUME:"true"}).REACT_APP_authDomain,databaseURL:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_USE_PHOTODIODE:"true",REACT_APP_USE_EEG:"true",REACT_APP_VOLUME:"true"}).REACT_APP_databaseURL,projectId:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_USE_PHOTODIODE:"true",REACT_APP_USE_EEG:"true",REACT_APP_VOLUME:"true"}).REACT_APP_projectId||"no-firebase",storageBucket:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_USE_PHOTODIODE:"true",REACT_APP_USE_EEG:"true",REACT_APP_VOLUME:"true"}).REACT_APP_storageBucket,messagingSenderId:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_USE_PHOTODIODE:"true",REACT_APP_USE_EEG:"true",REACT_APP_VOLUME:"true"}).REACT_APP_messagingSenderId,appId:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_USE_PHOTODIODE:"true",REACT_APP_USE_EEG:"true",REACT_APP_VOLUME:"true"}).REACT_APP_appId},V=N.a.initializeApp(M).firestore();"localhost"===window.location.hostname&&V.useEmulator("localhost",8080);var F=function(e,t,n){return V.collection("participant_responses").doc(t).collection("participants").doc(e).collection("data").doc(n).set({start_time:n,app_version:window.navigator.appVersion,app_platform:window.navigator.platform,results:[]}).then(function(){return!0}).catch(function(e){return!1})},x=function(e){console.log(e);var t=e.participant_id,n=e.study_id,r=e.start_date;V.collection("participant_responses").doc(n).collection("participants").doc(t).collection("data").doc(r).update("results",N.a.firestore.FieldValue.arrayUnion(e))},B=(N.a,n(43));var H=function(){var e=(new Date).toISOString(),t=Object(r.useState)(!1),n=Object(d.a)(t,2),a=n[0],i=n[1],c=Object(r.useState)(!1),l=Object(d.a)(c,2),p=l[0],b=l[1],h=Object(r.useState)(!1),v=Object(d.a)(h,2),O=v[0],g=v[1],w=Object(r.useState)(""),y=Object(d.a)(w,2),A=y[0],U=y[1],C=Object(r.useState)(""),S=Object(d.a)(C,2),T=S[0],I=S[1],R=Object(r.useState)("default"),j=Object(d.a)(R,2),k=j[0],D=j[1],N=Object(r.useState)(!1),M=Object(d.a)(N,2),V=M[0],H=M[1],G=new URLSearchParams(window.location.search),q=function(){var e=Object(u.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),z=function(e){},K=Object(r.useCallback)(function(t,n,r){t&&f.jsPsych.data.addProperties({participant_id:r,study_id:n,start_date:e,task_version:B.a}),i(t)},[e]);return Object(r.useEffect)(function(){if(console.log("Turk:",m.b.USE_MTURK),console.log("Firebase:",m.b.USE_FIREBASE),console.log("Prolific:",m.b.USE_PROLIFIC),console.log("Electron:",m.b.USE_ELECTRON),console.log("Video:",m.b.USE_CAMERA),console.log("Volume:",m.b.USE_VOLUME),console.log("Event Marker:",m.b.USE_EEG),console.log("Photodiode:",m.b.USE_PHOTODIODE),m.b.USE_ELECTRON){var e=window.require("electron").ipcRenderer;b(e),e.send("updateEnvironmentVariables",m.b);var t=e.sendSync("syncCredentials");t.envParticipantId&&U(t.envParticipantId),t.envStudyId&&I(t.envStudyId),D("desktop")}else if(m.b.USE_MTURK){window.lodash=_.noConflict();var n=Object(P.c)();g(new PsiTurk(n,"/complete")),D("mturk"),K(!0,"mturk",n)}else if(m.b.USE_PROLIFIC){var r=Object(P.b)();m.b.USE_FIREBASE&&r?(D("firebase"),K(!0,"prolific",r)):H(!0)}else if(m.b.USE_FIREBASE){D("firebase");var o=G.get("participantID"),a=G.get("studyID");o&&U(o),a&&I(a)}else H(!0)},[]),V?o.a.createElement("div",{className:"centered-h-v"},o.a.createElement("div",{className:"width-50 alert alert-danger"},"Please ask your task provider to enable firebase.")):o.a.createElement(o.a.Fragment,null,a?o.a.createElement(L,{dataUpdateFunction:{desktop:function(e){!0!==e.countdown&&p.send("data",e)},firebase:function(e){x(e)},mturk:function(e){O.recordTrialData(e)},default:z}[k],dataFinishFunction:{desktop:function(){p.send("end","true")},mturk:function(){!function(){var e=Object(u.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return O.saveData(),e.next=3,Object(P.d)(5e3);case 3:O.completeHIT();case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()()},firebase:z,default:z}[k]}):o.a.createElement(E,{validationFunction:{desktop:q,default:q,firebase:function(t,n){return F(t,n,e)}}[k],envParticipantId:A,envStudyId:T,onLogin:K}))};i.a.render(o.a.createElement(H,null),document.getElementById("root"))}},[[45,1,2]]]);
//# sourceMappingURL=main.4908c451.chunk.js.map